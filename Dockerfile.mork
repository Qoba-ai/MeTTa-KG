FROM rust:1.88-bookworm

RUN apt-get update && apt-get install -y git cmake

RUN git clone https://github.com/trueagi-io/MORK.git /app

WORKDIR /app

RUN git checkout server

# Clone the PathMap dependency to the absolute path expected by the manifest
RUN git clone --branch master https://github.com/Adam-Vandervorst/PathMap.git /PathMap

RUN cargo build --release -p mork_server --bin mork_server

EXPOSE 8001

CMD ["./target/release/mork_server"]